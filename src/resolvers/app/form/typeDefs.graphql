scalar StudentID

enum Club {
    UNIFOX
    LAYER7
    EMOTION
    NEFUS
    TEAMLOG
}

interface StudentInfo {
    studentId: StudentID!
    name: String! @constraint(maxLength: 5)
    phoneNumber: String! @constraint(pattern: "^010([0-9]{8})$")
}

type Student implements StudentInfo {
    studentId: StudentID!
    name: String! @constraint(maxLength: 5)
    phoneNumber: String! @constraint(pattern: "^010([0-9]{8})$")
}

type Form implements StudentInfo {
    studentId: StudentID!
    name: String! @constraint(maxLength: 5)
    club: Club!
    answerList: [String]!
    portfolioURL: URL
    otherURLs: [URL]!
    formId: ObjectID!
    date: DateTime!
    phoneNumber: String! @constraint(pattern: "^010([0-9]{8})$")
}

input CreateFormInput {
    studentId: StudentID!
    name: String! @constraint(maxLength: 5)
    club: Club!
    phoneNumber: String! @constraint(pattern: "^010([0-9]{8})$")
    answerList: [String!]!
    portfolioURL: URL
    otherURLs: [URL]!
}

type CreateFormInvalidInputError implements Error {
    message: String!
    path: String!
    suggestion: String!
}

type RateLimitError implements Error {
    message: String!
    path: String!
    suggestion: String!
    afterTry: UnsignedInt!
}

union CreateFormResult = Form | CreateFormInvalidInputError | RateLimitError

extend type Mutation {

    # 동아리 신청서 전송
    createForm(
        input: CreateFormInput!
    ): CreateFormResult! @ratelimit(ttl: 60, max: 10, key: "createForm", keyType: IP)
}

extend type Query {

    # 동아리 신청자 명단 조회
    getStudentByClub(
        club: Club!
    ): [Student!]! 

    # 동아리 지원 현황 가져오기
    getLiveFormStatus: [FormStatus!]!

    getFormByClub(
        club: Club!
        limit: UnsignedInt = 10
        cursor: ObjectID
    ): FormConnection!

     # 학번으로 신청서를 가져옵니다
    getFormByStudentId(
        studentId: StudentID!
        limit: UnsignedInt = 10
        cursor: ObjectID
    ): FormConnection!
}

type FormStatus {
    club: Club!
    formCount: UnsignedInt!
}

type FormEdge {
    node: Form!
    cursor: ObjectID!
}

type FormConnection {
    totalCount: UnsignedInt!
    edges: [FormEdge!]!
    pageInfo: CursorPageInfo!
}